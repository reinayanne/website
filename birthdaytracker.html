<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Queen Julie Website | Birthday Tracker</title>

<!-- FAVICON -->
<link rel="icon" type="image/png" sizes="64x64" href="adminfavicon.ico">

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>

/* VARIABLES */
:root{
--pink:#ff4fa3;
--pink-light:#ff7bbf;
--pink-dark:#c81e6d;
--glass-bg:rgba(255,123,191,.18);
--text-main:#ffffff;
}

*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}

body{
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
background:url("adminbackground.png") center/cover fixed no-repeat;
color:var(--text-main);
padding-top:90px;
min-height:100vh;
-webkit-font-smoothing:antialiased;
}

/* HEADER */
header{
position:fixed;top:0;left:0;width:100%;z-index:9999;
display:flex;justify-content:space-between;align-items:center;
padding:14px 16px;
backdrop-filter:blur(18px);
-webkit-backdrop-filter:blur(18px);
background:linear-gradient(270deg,#ff4fa3,#ff7bbf,#ffb3d9);
background-size:400% 400%;
animation:flow 12s ease infinite;
}
@keyframes flow{
0%{background-position:0%}
50%{background-position:100%}
100%{background-position:0%}
}

.header-left{display:flex;align-items:center;gap:10px;flex:1;min-width:0;}
.header-left img{height:36px;width:auto;}

.motto{
font-size:12px;
font-weight:600;
letter-spacing:.3px;
text-shadow:0 0 8px rgba(255,255,255,.4);
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
}

.header-icons{
display:flex;
align-items:center;
gap:12px;
flex-shrink:0;
margin-left:10px;
}

.header-icons a{
color:#fff;
font-size:18px;
transition:.25s;
cursor:pointer;
position:relative;
display:flex;
align-items:center;
justify-content:center;
width:36px;
height:36px;
border-radius:50%;
}

/* PINK GLOW HOVER */
.header-icons a:hover{
color:#ff4fa3;
text-shadow:
0 0 6px #ff7bbf,
0 0 14px #ff4fa3,
0 0 28px #ff4fa3,
0 0 42px #ff7bbf;
transform:scale(1.1);
background:rgba(255,255,255,0.1);
}

/* NOTIFICATION BADGE */
.notif-badge{
position:absolute;
top:2px;
right:2px;
width:10px;
height:10px;
background:#ff1744;
border-radius:50%;
border:2px solid #ff7bbf;
box-shadow:0 0 8px #ff1744;
animation:pulse 2s infinite;
display:none;
}
.notif-badge.active{display:block;}

@keyframes pulse{
0%{transform:scale(1);opacity:1;}
50%{transform:scale(1.2);opacity:0.8;}
100%{transform:scale(1);opacity:1;}
}

/* CONTAINER */
.container{
max-width:1400px;
margin:20px auto;
padding:15px;
background:rgba(255,255,255,.08);
backdrop-filter:blur(20px);
-webkit-backdrop-filter:blur(20px);
border-radius:20px;
box-shadow:0 25px 60px rgba(0,0,0,.25);
width:calc(100% - 30px);
}

.page-title{
text-align:center;
font-size:32px;
font-family:"Orbitron",sans-serif;
margin-bottom:25px;
font-weight:700;
text-shadow:0 0 20px rgba(255,79,163,0.5);
}

/* MONTH GRID */
.month-grid{
display:grid;
grid-template-columns:1fr;
gap:16px;
}

@media(min-width:640px){
.month-grid{grid-template-columns:repeat(2,1fr);gap:20px;}
.page-title{font-size:42px;}
.container{padding:25px;margin:30px auto;}
.motto{font-size:14px;}
.header-left img{height:42px;}
.header-icons a{font-size:20px;width:40px;height:40px;}
}

@media(min-width:1024px){
.month-grid{grid-template-columns:repeat(3,1fr);}
.page-title{font-size:54px;}
header{padding:18px 26px;}
.motto{font-size:15px;}
}

@media(min-width:1400px){
.month-grid{grid-template-columns:repeat(4,1fr);}
}

.month-card{
background:var(--glass-bg);
backdrop-filter:blur(14px);
-webkit-backdrop-filter:blur(14px);
border-radius:16px;
padding:15px;
box-shadow:0 10px 30px rgba(0,0,0,.25);
border:1px solid rgba(255,255,255,0.1);
}

.month-header{
font-size:20px;
font-weight:700;
text-align:center;
margin-bottom:8px;
font-family:"Orbitron",sans-serif;
}

@media(min-width:640px){
.month-header{font-size:24px;}
.month-card{padding:18px;}
}

/* PROGRESS */
.progress{
width:100%;
height:6px;
background:rgba(255,255,255,.15);
border-radius:20px;
overflow:hidden;
margin:8px 0 12px;
}
.progress-bar{
height:100%;
width:0%;
background:linear-gradient(90deg,#ff7bbf,#ff4fa3);
box-shadow:0 0 10px #ff7bbf;
transition:width 0.4s ease;
border-radius:20px;
}

/* BIRTHDAY ROW */
.birthday-list{display:flex;flex-direction:column;gap:8px;}

.bday{
display:flex;
align-items:center;
gap:8px;
background:rgba(255,255,255,.12);
padding:10px 12px;
border-radius:10px;
transition:all 0.3s ease;
touch-action:manipulation;
}

.bday:active{transform:scale(0.98);}

.bday.today{
background:linear-gradient(135deg,#ff4fa3,#ff7bbf);
box-shadow:0 0 20px #ff4fa3;
animation:glow 2s ease-in-out infinite alternate;
border:1px solid rgba(255,255,255,0.3);
}

@keyframes glow{
from{box-shadow:0 0 20px #ff4fa3;}
to{box-shadow:0 0 30px #ff4fa3,0 0 40px #ff7bbf;}
}

.bday input{
background:transparent;
border:none;
color:white;
outline:none;
width:100%;
font-size:14px;
font-family:inherit;
}

.bday input::placeholder{color:rgba(255,255,255,0.6);}

.bday input[type="checkbox"]{
transform:scale(1.3);
accent-color:#ff4fa3;
cursor:pointer;
min-width:18px;
min-height:18px;
}

.bday .name{flex:1;min-width:0;}
.bday .day{
width:50px;
text-align:right;
flex-shrink:0;
}

@media(min-width:640px){
.bday .day{width:60px;}
.bday input{font-size:15px;}
}

/* BUTTON */
.dgc-btn{
background:linear-gradient(135deg,#ff4fa3,#ff7bbf);
color:#fff;
border:none;
padding:12px;
border-radius:14px;
font-weight:600;
cursor:pointer;
transition:all 0.35s ease;
margin-top:10px;
width:100%;
font-size:14px;
font-family:inherit;
touch-action:manipulation;
-webkit-appearance:none;
}

.dgc-btn:hover{
box-shadow:0 0 18px #ff4fa3;
transform:translateY(-2px);
}

.dgc-btn:active{transform:translateY(0);}

/* TOAST NOTIFICATION */
.toast{
position:fixed;
bottom:20px;
left:50%;
transform:translateX(-50%) translateY(100px);
background:rgba(255,79,163,0.95);
color:white;
padding:12px 24px;
border-radius:25px;
font-weight:600;
font-size:14px;
box-shadow:0 10px 30px rgba(0,0,0,0.3);
backdrop-filter:blur(10px);
z-index:10000;
opacity:0;
transition:all 0.3s ease;
pointer-events:none;
}

.toast.show{
transform:translateX(-50%) translateY(0);
opacity:1;
}

/* SCROLLBAR */
::-webkit-scrollbar{width:8px;}
::-webkit-scrollbar-track{background:rgba(255,255,255,0.1);}
::-webkit-scrollbar-thumb{background:#ff4fa3;border-radius:4px;}
::-webkit-scrollbar-thumb:hover{background:#ff7bbf;}

/* SAFE AREA FOR NOTCH DEVICES */
@supports(padding:max(0px)){
header{padding-top:max(14px,env(safe-area-inset-top));}
body{padding-top:max(90px,calc(90px + env(safe-area-inset-top)));}
}

</style>
</head>

<body>

<header>
<div class="header-left">
 <img src="adminlogo.png" alt="Logo">
 <div class="motto">Celebrate Lives â€¢ Remember Smiles â€¢ Never Miss A Special Day ðŸŽ‚</div>
</div>

<div class="header-icons">
 <a href="homepage.html" id="homeBtn">
  <i class="fas fa-house"></i>
  <span class="notif-badge" id="homeBadge"></span>
 </a>
 <a id="musicToggle"><i class="fas fa-music"></i></a>
 <a id="logoutBtn"><i class="fas fa-right-from-bracket"></i></a>
</div>
</header>

<audio id="bgMusic" src="coffee.mp3" loop></audio>
<audio id="notifSound" src="notification.mp3" preload="auto"></audio>

<div class="container">
<div class="page-title">Birthday Tracker</div>
<div class="month-grid" id="months"></div>
</div>

<div class="toast" id="toast"></div>

<script>

/* LOGOUT */
document.getElementById("logoutBtn").onclick=()=>window.location.href="login.html";

/* MUSIC */
const bgMusic=document.getElementById("bgMusic");
const musicToggle=document.getElementById("musicToggle");
let musicPlaying=false;

musicToggle.onclick=()=>{
if(bgMusic.paused){
 bgMusic.volume=.6;
 bgMusic.play().catch(e=>console.log('Audio play failed:',e));
 musicToggle.innerHTML='<i class="fas fa-pause"></i>';
 musicPlaying=true;
}else{
 bgMusic.pause();
 musicToggle.innerHTML='<i class="fas fa-music"></i>';
 musicPlaying=false;
}
};

// Restore music state
if(localStorage.getItem('musicPlaying')==='true'){
bgMusic.volume=.6;
bgMusic.play().catch(e=>console.log('Autoplay blocked'));
musicToggle.innerHTML='<i class="fas fa-pause"></i>';
}

bgMusic.onplay=()=>localStorage.setItem('musicPlaying','true');
bgMusic.onpause=()=>localStorage.setItem('musicPlaying','false');

/* TOAST NOTIFICATION */
function showToast(message){
const toast=document.getElementById('toast');
toast.textContent=message;
toast.classList.add('show');
setTimeout(()=>toast.classList.remove('show'),3000);
}

/* SMART CLEAN EMPTY ROWS */
function cleanEmptyRows(){
document.querySelectorAll(".bday").forEach(row=>{
 const nameInput=row.querySelector(".name");
 const dayInput=row.querySelector(".day");

 const name=nameInput.value.trim();
 const day=dayInput.value.trim();

 const isFocused =
  document.activeElement===nameInput ||
  document.activeElement===dayInput;

 if(name==="" && day==="" && !isFocused){
  row.remove();
 }
});
}

/* STORAGE */
function saveData(){
cleanEmptyRows();

const data=[];
document.querySelectorAll(".month-card").forEach(card=>{
 const entries=[];
 card.querySelectorAll(".bday").forEach(row=>{
  const name=row.querySelector(".name").value.trim();
  const day=row.querySelector(".day").value.trim();
  const checked=row.querySelector("input[type='checkbox']").checked;

  if(name!=="" && day!==""){
   entries.push({name,day,checked});
  }
 });
 data.push(entries);
});

localStorage.setItem("birthdayData",JSON.stringify(data));
updateHomeBadge();
}

function loadData(){
return JSON.parse(localStorage.getItem("birthdayData")||"[]");
}

/* NOTIFICATION BADGE FOR HOMEPAGE */
function updateHomeBadge(){
const today=new Date();
const todayMonth=today.getMonth();
const todayDay=today.getDate();
const data=loadData();

let hasNotification=false;

if(data[todayMonth]){
 data[todayMonth].forEach(entry=>{
  if(parseInt(entry.day)===todayDay){
   hasNotification=true;
  }
 });
}

const badge=document.getElementById('homeBadge');
if(hasNotification){
 badge.classList.add('active');
}else{
 badge.classList.remove('active');
}
}

/* DATE TODAY */
const today=new Date();
const todayMonth=today.getMonth();
const todayDay=today.getDate();

/* CREATE MONTHS */
const months=["January","February","March","April","May","June","July","August","September","October","November","December"];
const container=document.getElementById("months");
const savedData=loadData();

// Track if we already played sound this session
let notifPlayed=sessionStorage.getItem('notifPlayed')==='true';

months.forEach((month,monthIndex)=>{

const card=document.createElement("div");
card.className="month-card";

card.innerHTML=`
<div class="month-header">${month}</div>
<div class="progress"><div class="progress-bar"></div></div>
<div class="birthday-list"></div>
<button class="dgc-btn"><i class="fas fa-plus"></i> Add Birthday</button>
`;

const list=card.querySelector(".birthday-list");
const bar=card.querySelector(".progress-bar");
const btn=card.querySelector("button");

function updateProgress(){
 const checks=list.querySelectorAll("input[type='checkbox']");
 if(checks.length===0){
  bar.style.width="0%";
  saveData();
  return;
 }
 const done=[...checks].filter(c=>c.checked).length;
 bar.style.width=Math.round((done/checks.length)*100)+"%";
 saveData();
}

function createRow(name="",day="",checked=false,isNew=false){
 const div=document.createElement("div");
 div.className="bday";
 div.innerHTML=`
  <input type="checkbox" ${checked?"checked":""}>
  <input class="name" placeholder="Name" value="${name}">
  <input class="day" type="number" min="1" max="31" placeholder="Day" value="${day}">
 `;

 const checkbox=div.querySelector("input[type='checkbox']");
 const nameInput=div.querySelector(".name");
 const dayInput=div.querySelector(".day");

 checkbox.onchange=()=>{
  updateProgress();
  saveData();
 };

 nameInput.oninput=()=>{
  saveData();
 };
 
 dayInput.oninput=()=>{
  // Validate day input
  let val=parseInt(dayInput.value);
  if(val<1)dayInput.value=1;
  if(val>31)dayInput.value=31;
  saveData();
 };

 nameInput.onblur=()=>{
  saveData();
  if(nameInput.value.trim()!==""){
   showToast(`Saved: ${nameInput.value.trim()}`);
  }
 };
 
 dayInput.onblur=()=>{
  saveData();
 };

 // Check if today
 if(monthIndex===todayMonth && parseInt(day)===todayDay && name!==""){
  div.classList.add("today");
  
  // Play notification sound only once per session
  if(!notifPlayed){
   const notifSound=document.getElementById("notifSound");
   notifSound.volume=0.5;
   notifSound.play().catch(e=>console.log('Notification sound failed:',e));
   notifPlayed=true;
   sessionStorage.setItem('notifPlayed','true');
   showToast(`ðŸŽ‰ Today is ${name}'s Birthday!`);
  }
 }

 list.appendChild(div);
 
 // Focus on name if new row
 if(isNew){
  setTimeout(()=>nameInput.focus(),100);
 }
}

// Load saved data
if(savedData[monthIndex] && savedData[monthIndex].length>0){
 savedData[monthIndex].forEach(e=>createRow(e.name,e.day,e.checked));
}

btn.onclick=()=>createRow("","",false,true);

updateProgress();
container.appendChild(card);
});

// Initialize badge on load
updateHomeBadge();

// Real-time sync across tabs
window.addEventListener('storage',(e)=>{
if(e.key==='birthdayData'){
 // Reload page to sync data
 location.reload();
}
});

// Auto-save on page hide/visibility change
document.addEventListener('visibilitychange',()=>{
if(document.hidden){
 saveData();
}
});

// Save before unload
window.addEventListener('beforeunload',()=>{
saveData();
});

// Periodic save every 30 seconds as backup
setInterval(saveData,30000);

</script>
</body>
</html>