<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Manager Julie | Budget Tracker</title>

<!-- FAVICON -->
<link rel="icon" type="image/png" sizes="64x64" href="adminfavicon.ico">

<!-- FONT -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&display=swap" rel="stylesheet">

<!-- ICONS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- CHART.JS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --pink:#ff4fa3;
  --pink-light:#ff7bbf;
  --pink-dark:#c81e6d;
  --pink-soft:#ffd6e8;
  --glass-bg:rgba(255,255,255,0.12);
  --text-main:#ffffff;
}

/* RESET */
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:url("adminbackground.png") center/cover fixed no-repeat;
  color:var(--text-main);
  -webkit-tap-highlight-color:transparent;
}

/* SCROLLBAR */
::-webkit-scrollbar{width:12px;}
::-webkit-scrollbar-track{background:rgba(255,192,223,.35);border-radius:10px;}
::-webkit-scrollbar-thumb{background:linear-gradient(180deg,var(--pink-light),var(--pink),var(--pink-dark));border-radius:10px;border:2px solid rgba(255,255,255,.4);}
::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,var(--pink),var(--pink-dark));}
*{scrollbar-width:thin;scrollbar-color:var(--pink) rgba(255,192,223,.4);}

/* LOADER */
#loader{position:fixed; inset:0;background:var(--pink-light);display:flex;align-items:center;justify-content:center;z-index:9999;transition:.4s ease;}
#loader.fade-out{opacity:0;visibility:hidden;}
.loader-content{display:flex;flex-direction:column;align-items:center;}
.loader-content img{width:120px;height:auto;margin-bottom:20px;}
.arc-spinner{width:50px;height:50px;border:5px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:spin 1s linear infinite;}
@keyframes spin{100%{transform:rotate(360deg);}}

/* HEADER */
header{
  position:sticky;top:0;z-index:1000;
  display:flex;justify-content:space-between;align-items:center;
  padding:18px 26px;
  backdrop-filter:blur(18px);
  background:linear-gradient(270deg,#ff4fa3,#ff7bbf,#ffb3d9);
  background-size:400% 400%;
  animation:flow 12s ease infinite;
}
@keyframes flow{
  0%{background-position:0%}
  50%{background-position:100%}
  100%{background-position:0%}
}

.header-left{
  display:flex;
  align-items:center;
  gap:14px;
}
.header-left img{height:46px}

/* MOTTO */
.motto{
  font-size:18px;
  font-weight:600;
  font-style:italic;
  letter-spacing:.6px;
  display:flex;
  align-items:center;
  gap:8px;
  white-space:nowrap;
}
.motto i{
  opacity:.95;
  font-size:17px;
}

/* ICONS */
.header-icons{display:flex;align-items:center}

.header-icons a{
  width:42px;height:42px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  border-radius:14px;
  margin-left:10px;
  transition:.3s;
  position:relative;
}

.header-icons i{font-size:18px}
.header-icons a:hover{box-shadow:0 0 14px rgba(255,79,163,.8)}
.header-icons a.active{animation:pulse 1.8s infinite}

@keyframes pulse{
  0%{box-shadow:0 0 0 rgba(255,79,163,.8)}
  70%{box-shadow:0 0 22px rgba(255,79,163,1)}
  100%{box-shadow:0 0 0 rgba(255,79,163,.6)}
}
header img{height:60px;}
.header-icons a{margin-left:15px;color:white;font-size:1.3rem;cursor:pointer;transition:.3s;}
.header-icons a:hover{color:var(--pink);}

/* NOTIFICATION BADGE */
.notif-badge{
  position:absolute;
  top:-2px;
  right:-2px;
  width:20px;
  height:20px;
  background:var(--pink);
  color:#fff;
  border-radius:50%;
  font-size:11px;
  font-weight:700;
  display:flex;
  align-items:center;
  justify-content:center;
  border:2px solid #fff;
  animation:pulse-badge 2s infinite;
  display:none;
}
.notif-badge.show{display:flex;}
@keyframes pulse-badge{
  0%{transform:scale(1)}
  50%{transform:scale(1.1)}
  100%{transform:scale(1)}
}

/* PAGE TITLE */
.page-title{text-align:center;font-size:2rem;font-weight:700;color:#ffffff;margin:20px 0;text-transform:uppercase;}

/* TOP CONTAINERS */
.top-containers{display:flex;justify-content:center;gap:20px;max-width:1200px;margin:0 auto 40px auto;}

/* SUMMARY CARD */
.summary-card{flex:1;background:#ffffff;border:3px solid var(--pink);color:var(--pink);padding:25px 20px;border-radius:25px;box-shadow:0 10px 30px rgba(255,79,163,.25);display:flex;flex-direction:column;align-items:center;gap:15px;}
.summary-card select{padding:6px 10px;border-radius:12px;border:none;outline:none;font-size:1rem;margin-bottom:10px;cursor:pointer;color:var(--pink);}
.big-number{font-size:1.8rem;font-weight:700;color:var(--pink);}

/* CHART CARD */
.chart-card{flex:1;background:var(--glass-bg);backdrop-filter:blur(15px);padding:20px;border-radius:20px;display:flex;flex-direction:column;align-items:center;justify-content:center;}
.chart-card canvas{max-width:200px !important;max-height:200px !important;}

/* SAVINGS CARD */
.savings-card{flex:1;background:var(--pink-soft);color:#000;display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:20px;padding:20px;}
.savings-card p{margin:5px 0;font-weight:700;}

/* TABLE CONTAINERS - GLASSMORPHISM */
.table-container{max-width:1200px;display:flex;gap:20px;margin:0 auto 40px auto;}
.card{flex:1;background:var(--glass-bg);backdrop-filter:blur(15px);color:#fff;border-radius:20px;padding:20px;}
.card h3{text-align:center;margin-bottom:15px;color:#fff;}
table{width:100%; border-collapse:collapse; margin-top:10px; table-layout:fixed; background:rgba(255,255,255,0.15); color:var(--pink);}
th,td{padding:5px 3px;text-align:left;font-size:0.85rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
th{border-bottom:1px solid var(--pink); color:var(--pink);}
td{border-bottom:1px solid rgba(255,255,255,0.1); color:#fff;}
input[type=date]{background:#fff;color:#000;}
.dgc-btn{background:linear-gradient(135deg,#ff4fa3,#ff7bbf);color:#fff;border:none;padding:10px 16px;border-radius:18px;font-weight:600;cursor:pointer;transition:.35s;box-shadow:0 6px 20px rgba(255,79,163,.45);margin-top:5px;}
.dgc-btn:hover{background:#fff;color:#ff4fa3;border:2px solid #ff4fa3;transform:translateY(-2px) scale(1.02);}

/* ADD CATEGORY WHITE */
#categoryInput{margin-top:10px;background:#ffffff;padding:10px;border-radius:15px;display:flex;justify-content:center;gap:10px;}
#categoryInput input{flex:1;color:#000;}

/* DELETE BUTTON */
button.delete-btn{background:none;border:none;color:#fff;cursor:pointer;font-size:1rem;transition:.3s;}
button.delete-btn i{color:#fff;}
button.delete-btn:hover i{color:var(--pink);}

/* SCROLL TO TOP */
#scrollBtn{position:fixed;bottom:30px;right:30px;background:var(--pink);color:#fff;border:none;padding:12px 16px;border-radius:50%;cursor:pointer;display:none;z-index:999;}
#scrollBtn.show{display:block;}

/* CUSTOM NOTIFICATION */
#notif-container{
  position:fixed;
  top:80px;
  right:20px;
  z-index:10000;
  display:flex;
  flex-direction:column;
  gap:10px;
  max-width:300px;
}
.notif-item{
  background:linear-gradient(135deg,var(--pink),var(--pink-light));
  color:#fff;
  padding:15px 20px;
  border-radius:15px;
  box-shadow:0 10px 30px rgba(0,0,0,0.3);
  display:flex;
  align-items:center;
  gap:12px;
  animation:slideIn 0.3s ease, fadeOut 0.3s ease 4.7s;
  cursor:pointer;
  border:2px solid rgba(255,255,255,0.3);
}
.notif-item i{font-size:20px;}
.notif-item-content{flex:1;}
.notif-item-title{font-weight:700;font-size:14px;margin-bottom:2px;}
.notif-item-text{font-size:12px;opacity:0.9;}
@keyframes slideIn{
  from{transform:translateX(100%);opacity:0;}
  to{transform:translateX(0);opacity:1;}
}
@keyframes fadeOut{
  from{opacity:1;}
  to{opacity:0;}
}

/* MOBILE RESPONSIVE */
@media screen and (max-width:768px){
  body{font-size:14px;}
  header{padding:12px 15px;}
  .header-left img{height:36px;}
  .header-icons a{width:36px;height:36px;margin-left:8px;}
  .header-icons i{font-size:16px;}
  .page-title{font-size:1.5rem;margin:15px 0;}
  .top-containers{flex-direction:column;padding:0 15px;margin-bottom:20px;}
  .summary-card,.chart-card,.savings-card{width:100%;}
  .table-container{flex-direction:column;padding:0 15px;}
  .card{width:100%;padding:15px;}
  table{font-size:12px;}
  th,td{padding:8px 5px;}
  input,select{width:100%;margin:5px 0;padding:10px;font-size:16px;}
  #categoryInput{flex-direction:column;}
  .dgc-btn{width:100%;margin-top:10px;}
  #scrollBtn{bottom:20px;right:20px;padding:10px 14px;}
  #notif-container{top:70px;right:10px;left:10px;max-width:none;}
}

@media screen and (max-width:480px){
  .page-title{font-size:1.2rem;}
  .big-number{font-size:1.4rem;}
  .summary-card{padding:20px 15px;}
  th,td{font-size:11px;padding:6px 4px;}
  .notif-item{padding:12px 15px;}
}

/* TOUCH OPTIMIZATIONS */
@media (hover:none) and (pointer:coarse){
  .dgc-btn:active{transform:scale(0.98);}
  button.delete-btn:active i{color:var(--pink);}
}
</style>
</head>
<body>

<!-- LOADER -->
<div id="loader">
  <div class="loader-content">
    <img src="adminlogo.png" alt="Logo">
    <div class="arc-spinner"></div>
  </div>
</div>

<!-- NOTIFICATION CONTAINER -->
<div id="notif-container"></div>

<!-- HEADER -->
<header>
  <div class="header-left">
    <a href="homepage.html"><img src="adminlogo.png" alt="Logo"></a>
  </div>
  <div class="header-icons">
    <a href="homepage.html" id="homeBtn">
      <i class="fas fa-house"></i>
      <span class="notif-badge" id="homeBadge">!</span>
    </a>
    <a id="musicToggle"><i class="fas fa-music"></i></a>
    <a id="logoutBtn"><i class="fas fa-right-from-bracket"></i></a>
  </div>
</header>

<!-- PAGE TITLE -->
<div class="page-title">BUDGET TRACKER</div>

<!-- TOP CONTAINERS -->
<div class="top-containers">
  <!-- SUMMARY CARD -->
  <div class="summary-card">
    <h2>SUMMARY</h2>
    <select id="monthSelect" onchange="renderBudget()">
      <option value="0">January</option>
      <option value="1">February</option>
      <option value="2">March</option>
      <option value="3">April</option>
      <option value="4">May</option>
      <option value="5">June</option>
      <option value="6">July</option>
      <option value="7">August</option>
      <option value="8">September</option>
      <option value="9">October</option>
      <option value="10">November</option>
      <option value="11">December</option>
    </select>
    <p>Total Income: <span id="totalIncome" class="big-number">₱0</span></p>
    <p>Total Expenses: <span id="totalExpenses" class="big-number">₱0</span></p>
    <p>Balance: <span id="balance" class="big-number">₱0</span></p>
  </div>

  <!-- DONUT CHART -->
  <div class="chart-card">
    <h2>EXPENSES BREAKDOWN</h2>
    <canvas id="donutChart"></canvas>
  </div>

  <!-- SAVINGS CARD -->
  <div class="savings-card">
    <h2>TOTAL SAVINGS</h2>
    <p id="totalSavings">₱0</p>
    <p id="savingsPercent">0% increase</p>
  </div>
</div>

<!-- TABLE CONTAINERS -->
<div class="table-container">
  <div class="card">
    <h3>INCOME</h3>
    <table>
      <thead><tr><th>Date</th><th>Source</th><th>Amount</th><th>Action</th></tr></thead>
      <tbody id="incomeList"></tbody>
    </table>
    <input type="date" id="incomeDate">
    <input type="text" id="incomeSource" placeholder="Source">
    <input type="number" id="incomeAmount" placeholder="Amount">
    <button class="dgc-btn" onclick="addIncome()">Add Income</button>
  </div>

  <div class="card">
    <h3>EXPENSES</h3>
    <table>
      <thead><tr><th>Date</th><th>Item</th><th>Amount</th><th>Category</th><th>Action</th></tr></thead>
      <tbody id="expenseList"></tbody>
    </table>
    <input type="date" id="expenseDate">
    <input type="text" id="expenseItem" placeholder="Item">
    <input type="number" id="expenseAmount" placeholder="Amount">
    <select id="expenseCategory"></select>
    <button class="dgc-btn" onclick="addExpense()">Add Expense</button>

    <div id="categoryInput">
      <input type="text" id="newCategory" placeholder="Add Category">
      <button class="dgc-btn" onclick="addCategory()"><i class="fas fa-plus"></i> Add</button>
    </div>
  </div>
</div>

<!-- AUDIO -->
<audio id="bgMusic" src="coffee.mp3" loop></audio>
<audio id="notifSound" src="notification.mp3"></audio>

<!-- SCROLL TO TOP -->
<button id="scrollBtn"><i class="fas fa-arrow-up"></i></button>

<script>
// LOADER
const loader=document.getElementById("loader");
window.addEventListener("load",()=>{setTimeout(()=>loader.classList.add("fade-out"),300);});

// MUSIC
const bgMusic=document.getElementById("bgMusic");
const musicToggle=document.getElementById("musicToggle");
musicToggle.onclick=()=>{bgMusic.paused?(bgMusic.volume=.6,bgMusic.play(),musicToggle.innerHTML='<i class="fas fa-pause"></i>'):(bgMusic.pause(),musicToggle.innerHTML='<i class="fas fa-music"></i>');};

// SCROLL TO TOP
const scrollBtn=document.getElementById("scrollBtn");
window.addEventListener("scroll",()=>{scrollBtn.classList.toggle("show",window.scrollY>300);});
scrollBtn.onclick=()=>{window.scrollTo({top:0,behavior:"smooth"});};

// LOCAL STORAGE FUNCTIONS
const STORAGE_KEYS = {
  CATEGORIES: 'julie_budget_categories',
  INCOMES: 'julie_budget_incomes',
  EXPENSES: 'julie_budget_expenses',
  NOTIFICATIONS: 'julie_budget_notifications'
};

function saveToStorage(){
  localStorage.setItem(STORAGE_KEYS.CATEGORIES, JSON.stringify(categories));
  localStorage.setItem(STORAGE_KEYS.INCOMES, JSON.stringify(incomes));
  localStorage.setItem(STORAGE_KEYS.EXPENSES, JSON.stringify(expenses));
}

function loadFromStorage(){
  const savedCategories = localStorage.getItem(STORAGE_KEYS.CATEGORIES);
  const savedIncomes = localStorage.getItem(STORAGE_KEYS.INCOMES);
  const savedExpenses = localStorage.getItem(STORAGE_KEYS.EXPENSES);
  
  if(savedCategories) categories = JSON.parse(savedCategories);
  if(savedIncomes) incomes = JSON.parse(savedIncomes);
  if(savedExpenses) expenses = JSON.parse(savedExpenses);
}

// NOTIFICATION SYSTEM
const notifSound = document.getElementById("notifSound");
const homeBadge = document.getElementById("homeBadge");
let notifications = JSON.parse(localStorage.getItem(STORAGE_KEYS.NOTIFICATIONS) || '[]');

function showNotification(title, message, type='info'){
  // Create visual notification
  const container = document.getElementById("notif-container");
  const notif = document.createElement("div");
  notif.className = "notif-item";
  
  const icon = type === 'success' ? 'fa-check-circle' : 
               type === 'warning' ? 'fa-exclamation-triangle' : 'fa-bell';
  
  notif.innerHTML = `
    <i class="fas ${icon}"></i>
    <div class="notif-item-content">
      <div class="notif-item-title">${title}</div>
      <div class="notif-item-text">${message}</div>
    </div>
  `;
  
  container.appendChild(notif);
  
  // Play sound
  notifSound.currentTime = 0;
  notifSound.volume = 0.5;
  notifSound.play().catch(e => console.log('Audio play failed:', e));
  
  // Show badge on homepage icon
  homeBadge.classList.add("show");
  
  // Save notification
  notifications.push({
    title,
    message,
    type,
    timestamp: new Date().toISOString(),
    read: false
  });
  localStorage.setItem(STORAGE_KEYS.NOTIFICATIONS, JSON.stringify(notifications));
  
  // Remove after 5 seconds
  setTimeout(() => {
    notif.remove();
  }, 5000);
}

function clearNotifications(){
  notifications = [];
  localStorage.removeItem(STORAGE_KEYS.NOTIFICATIONS);
  homeBadge.classList.remove("show");
}

// Check for existing notifications on load
function checkExistingNotifications(){
  const unread = notifications.filter(n => !n.read).length;
  if(unread > 0 || notifications.length > 0){
    homeBadge.classList.add("show");
  }
}

// DATA
let categories=['Bills','Needs','Wants','Savings'];
let incomes=[];
let expenses=[];

// Load saved data
loadFromStorage();

// INIT CATEGORY DROPDOWN
const expenseSelect=document.getElementById("expenseCategory");
function updateCategoryDropdown(){
  expenseSelect.innerHTML='';
  categories.forEach(c=>{
    const opt=document.createElement("option");
    opt.value=c; opt.text=c;
    expenseSelect.appendChild(opt);
  });
}
updateCategoryDropdown();

// ADD CATEGORY
function addCategory(){
  const val=document.getElementById("newCategory").value.trim();
  if(val && !categories.includes(val)){
    categories.push(val);
    updateCategoryDropdown();
    document.getElementById("newCategory").value='';
    saveToStorage();
    renderBudget();
    showNotification('Category Added', `"${val}" has been added to categories`, 'success');
  }
}

// ADD INCOME
function addIncome(){
  const date=document.getElementById("incomeDate").value;
  const source=document.getElementById("incomeSource").value.trim();
  const amount=parseFloat(document.getElementById("incomeAmount").value);
  if(date && source && !isNaN(amount)){
    incomes.push({date,source,amount});
    saveToStorage();
    renderBudget();
    document.getElementById("incomeDate").value='';
    document.getElementById("incomeSource").value='';
    document.getElementById("incomeAmount").value='';
    showNotification('Income Added', `₱${amount.toFixed(2)} from ${source}`, 'success');
  }
}

// ADD EXPENSE
function addExpense(){
  const date=document.getElementById("expenseDate").value;
  const item=document.getElementById("expenseItem").value.trim();
  const amount=parseFloat(document.getElementById("expenseAmount").value);
  const category=document.getElementById("expenseCategory").value;
  if(date && item && !isNaN(amount)){
    expenses.push({date,item,amount,category});
    saveToStorage();
    renderBudget();
    document.getElementById("expenseDate").value='';
    document.getElementById("expenseItem").value='';
    document.getElementById("expenseAmount").value='';
    showNotification('Expense Added', `₱${amount.toFixed(2)} for ${item}`, 'warning');
  }
}

// DELETE FUNCTIONS
function deleteIncome(index){
  const deleted = incomes[index];
  incomes.splice(index,1);
  saveToStorage();
  renderBudget();
  showNotification('Income Deleted', `Removed ₱${deleted.amount.toFixed(2)} from ${deleted.source}`, 'warning');
}
function deleteExpense(index){
  const deleted = expenses[index];
  expenses.splice(index,1);
  saveToStorage();
  renderBudget();
  showNotification('Expense Deleted', `Removed ₱${deleted.amount.toFixed(2)} for ${deleted.item}`, 'warning');
}

// MONTH & SUMMARY RENDER
let donutChart;
const monthSelect = document.getElementById("monthSelect");
monthSelect.value = new Date().getMonth();

// Count-up animation helper
function animateValue(id, start, end, duration){
  let obj=document.getElementById(id);
  let range=end-start;
  let minTimer=50;
  let stepTime=Math.abs(Math.floor(duration/range));
  stepTime=Math.max(stepTime,minTimer);
  let startTime=new Date().getTime();
  let endTime=startTime+duration;
  let timer=setInterval(function(){
    let now=new Date().getTime();
    let remaining=Math.max((endTime-now)/duration,0);
    let value=Math.round(end - (remaining*range));
    if(id==="totalSavings") obj.textContent="₱"+value.toLocaleString();
    else obj.textContent=value.toFixed(1)+"% increase";
    if(value===end) clearInterval(timer);
  },stepTime);
}

function renderBudget(){
  const selectedMonth = parseInt(monthSelect.value);
  const incomeList=document.getElementById("incomeList");
  const expenseList=document.getElementById("expenseList");
  incomeList.innerHTML=''; expenseList.innerHTML='';

  let totalIncome=0, totalExpenses=0;
  const categoryTotals={}; categories.forEach(c=>categoryTotals[c]=0);

  incomes.forEach((i,index)=>{
    const incomeMonth = new Date(i.date).getMonth();
    if(incomeMonth === selectedMonth){
      totalIncome+=i.amount;
      incomeList.innerHTML+=`<tr>
        <td>${i.date}</td><td>${i.source}</td><td>₱${i.amount.toFixed(2)}</td>
        <td><button class="delete-btn" onclick="deleteIncome(${index})"><i class="fas fa-trash"></i></button></td>
      </tr>`;
    }
  });

  expenses.forEach((e,index)=>{
    const expenseMonth = new Date(e.date).getMonth();
    if(expenseMonth === selectedMonth){
      totalExpenses+=e.amount;
      categoryTotals[e.category]+=e.amount;
      expenseList.innerHTML+=`<tr>
        <td>${e.date}</td><td>${e.item}</td><td>₱${e.amount.toFixed(2)}</td><td>${e.category}</td>
        <td><button class="delete-btn" onclick="deleteExpense(${index})"><i class="fas fa-trash"></i></button></td>
      </tr>`;
    }
  });

  document.getElementById("totalIncome").textContent="₱"+totalIncome.toFixed(2);
  document.getElementById("totalExpenses").textContent="₱"+totalExpenses.toFixed(2);
  const balance = totalIncome-totalExpenses;
  document.getElementById("balance").textContent="₱"+balance.toFixed(2);

  const ctx=document.getElementById("donutChart").getContext("2d");
  if(donutChart) donutChart.destroy();
  donutChart=new Chart(ctx,{
    type:'doughnut',
    data:{labels:Object.keys(categoryTotals), datasets:[{data:Object.values(categoryTotals),
      backgroundColor:['rgba(255,79,163,0.7)','rgba(255,123,191,0.7)','rgba(200,30,109,0.7)','rgba(255,192,223,0.7)']}]},
    options:{plugins:{legend:{position:'bottom'}},responsive:true}
  });

  // TOTAL SAVINGS
  const yearlyIncome = incomes.reduce((acc,i)=>acc+i.amount,0);
  const yearlyExpenses = expenses.reduce((acc,e)=>acc+e.amount,0);
  const totalSavings = yearlyIncome - yearlyExpenses;
  animateValue("totalSavings", 0, totalSavings, 1000);

  // AUTOMATIC PERCENTAGE CHANGE
  const prevSavings = yearlyIncome - yearlyExpenses - balance;
  const percent = prevSavings>0 ? ((totalSavings-prevSavings)/prevSavings)*100 : 0;
  animateValue("savingsPercent", 0, percent, 1000);
}

// Check for existing notifications on page load
checkExistingNotifications();

// Initial render
renderBudget();

// Real-time update every 30 seconds (in case of multi-tab usage)
setInterval(() => {
  loadFromStorage();
  renderBudget();
}, 30000);

// Clear badge when clicking home (simulate reading notifications)
document.getElementById("homeBtn").addEventListener("click", function(e){
  if(notifications.length > 0){
    // Mark all as read
    notifications.forEach(n => n.read = true);
    localStorage.setItem(STORAGE_KEYS.NOTIFICATIONS, JSON.stringify(notifications));
    homeBadge.classList.remove("show");
  }
});
</script>
</body>
</html>